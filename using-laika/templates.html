<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>Laika</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Customizable and extensible toolkit for transforming lightweight markup languages to various types of output formats, written in Scala" />
    <meta name="keywords" content="scala, text, markup, markdown, restructuredtext, parser, transformer, html, template engine, site generation, open-source" />

    <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.207/distr/fira_code.css">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/docs.css" rel="stylesheet">

  </head>

  <body data-spy="scroll" data-target=".toc" data-offset="200">


  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span4 toc" >
        
        <ul class="nav nav-list affix">
          <div class="nav-top"><img src="../img/laika-top.png"/></div>
          
          
          <li class="nav-header">Introduction</li>
          <li><a href="../introduction/intro.html">Overview</a></li>
          <li><a href="../introduction/architecture.html">Architecture</a></li>
          <li class="nav-header">Using Laika</li>
          <li><a href="sbt.html">Using the sbt Plugin</a></li>
          <li><a href="embedded.html">Using the Library API</a></li>
          <li><a href="markup.html">Supported Markup</a></li>
          <li><a href="output.html">Supported Output Formats</a></li>
          <li><a href="structure.html">Document Structure</a></li>
          <li class="active"><a href="#">Templates</a></li>
          <li><a href="syntax.html">Syntax Highlighting</a></li>
          <li class="nav-header">Customizing Laika</li>
          <li><a href="../customizing-laika/customize-rendering.html">Customizing Renderers</a></li>
          <li><a href="../customizing-laika/tree-rewriting.html">Document Tree Rewriting</a></li>
          <li><a href="../customizing-laika/parsing-rendering.html">Separate Parsing and Rendering</a></li>
          <li class="nav-header">Extending Laika</li>
          <li><a href="../extending-laika/directive.html">Directives</a></li>
          <li><a href="../extending-laika/parser.html">Parsers</a></li>
          <li><a href="../extending-laika/renderer.html">Renderers</a></li>
          <li><a href="../extending-laika/extending-rst.html">Extending reStructuredText</a></li>
          
          <li class="nav-header">Project Links</li>
          <li><a href="http://github.com/planet42/Laika">Source Code</a></li>
          <li><a href="../api/laika/api/">API Documentation</a></li>
          <li><a href="http://github.com/planet42/Laika/issues">Issue Tracker</a></li>
          <li><a href="http://planet42.org/">Transformer Web Tool</a></li>
          <li class="follow"><a href="https://twitter.com/_planet42" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false" data-dnt="true">Follow @_planet42</a>
          <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></li>
          
          <div class="nav-bottom"><img src="../img/laika-bottom.png" border="1"/></div>
        </ul>
        
      </div>
      
      <div class="span8" id="top">

        <div class="page-header">
        <h1>Templates</h1>
        </div>
        <p>Laika comes with a lightweight, logic-less template engine that allows you to customize the output
        of the transformed markup documents.</p>
        <p>It is different than common template engines as the mechanisms to implement custom
        logic in tags differs from most other template systems. These tags do not immediately 
        render the final string output. Instead, they insert nodes into the document tree model (a tree
        of case classes) which are not specific to any particular output format. 
        As a result, a custom template directive can be reused for different output formats.</p>
        <p>The engine also differs from template engines in the Scala ecosystem in that it does not
        get compiled. The resulting lack of type safety is a negligible issue, since in the particular
        context of text markup transformation most of the things you refer to from a template
        do not originate in program code anyway, but instead come from markup and configuration 
        files. It also helps keeping the engine very lightweight. </p>
        <p>The parsing of a template is therefore very similar
        to the parsing of text markup in that the interim result is a tree of case classes.
        Applying a template to a markup document then only means inserting nodes from one
        into the other before rendering, based on the types and location of tags you 
        used in the template. </p>
        
        <h2 id="template-syntax" class="section">Template Syntax</h2>
        <p>The following example shows all three markup constructs you can use in
        templates:</p>
        <pre><code class="nohighlight"><span class="keyword">{%</span><span> 
  </span><span class="attribute-name">autonumbering</span><span> {
    </span><span class="attribute-name">scope</span><span>: </span><span class="string-literal">sections</span><span>
    </span><span class="attribute-name">depth</span><span>: </span><span class="number-literal">2</span><span>      
  }
</span><span class="keyword">%}</span><span>  
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">html</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;</span><span class="tag-name">head</span><span class="tag-punctuation">&gt;</span><span>
    </span><span class="tag-punctuation">&lt;</span><span class="tag-name">title</span><span class="tag-punctuation">&gt;</span><span class="substitution">${document.title}</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">title</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;/</span><span class="tag-name">head</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;</span><span class="tag-name">body</span><span class="tag-punctuation">&gt;</span><span>
    </span><span class="keyword">@:</span><span class="identifier">toc</span><span>
    </span><span class="tag-punctuation">&lt;</span><span class="tag-name">div</span><span class="tag-punctuation"> </span><span class="attribute-name">class</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;content&quot;</span><span class="tag-punctuation">&gt;</span><span>
      </span><span class="substitution">${document.content}</span><span>
    </span><span class="tag-punctuation">&lt;/</span><span class="tag-name">div</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;/</span><span class="tag-name">body</span><span class="tag-punctuation">&gt;</span><span>
</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">html</span><span class="tag-punctuation">&gt;</span></code></pre>
        <p>It contains a configuration header (enclosed between <code>{%</code> and <code>%}</code>),
        two variable references (enclosed between <code>${</code> and <code>}</code>) and
        a standard directive (starting with <code>@:</code>), in this case the
        <code>toc</code> directive for generating a table of contents.</p>
        <p>These three constructs are described in the following sections.</p>
        
        <h3 id="configuration-headers" class="section">Configuration Headers</h3>
        <p>A configuration header can only appear at the beginning of a
        template document and has to be enclosed between <code>{%</code> and <code>%}</code>.
        The supported syntax is equivalent to the one used in the
        <a href="https://github.com/typesafehub/config">Typesafe Config</a> library. It is a superset of JSON called <a href="https://github.com/typesafehub/config#features-of-hocon">HOCON</a>.</p>
        <p>Laika comes with its own parser implementation for HOCON,
        to retain the overall design of full referential transparency
        and avoid the Java API of the Typesafe Config library.</p>
        <p>There are a few configuration entries that have a special meaning
        for Laika, like the <code>autonumbering</code> entry in the example above.
        These are all documented in their respective chapters.</p>
        <p>But you can also add arbitrary entries and then refer to them
        from a variable reference. The <code>scope</code> entry above for example
        can be referred to with <code>${autonumbering.scope}</code>.</p>
        <p>You can also have a configuration header in a markup document
        (supported for both Markdown and reStructuredText) and then
        refer to entries in a header in a markup document from
        inside the corresponding template (and vice versa)</p>
        
        <h3 id="variable-references" class="section">Variable References</h3>
        <p>A variable reference can appear anywhere in a template
        and has to be enclosed between <code>${</code> and <code>}</code>. During
        rewriting these references get replaced by their corresponding
        value, which may be a standard document node which gets inserted
        into the tree or a simple string.</p>
        <p>These are the variables you can use in templates:</p>
        <ul>
          <li><code>document.content</code>: inserts the full content from the corresponding
          markup document at the location of the reference</li>
          <li><code>document.title</code>: inserts the title of the document, see
          <a href="structure.html#document-title">Document Title</a> for details</li>
          <li><code>document.fragments</code>: inserts the fragment with the corresponding
          name into the template (e.g. <code>document.fragments.footer</code> refers to
          the fragment with the name <code>footer</code>), see <a href="structure.html#document-fragments">Document Fragments</a>
          for details.</li>
          <li><code>document.path</code>: the absolute (virtual) path of the document inside the tree</li>
          <li><code>parent.path</code> the path of the immediate parent tree of this document</li>
          <li><code>parent.title</code> the title of the parent tree </li>
          <li><code>root.title</code>: the title of the root tree</li>
          <li>
            any other path: let&#39;s you access any configuration variable, e.g. ${autonumbering.scope}
            refers to the scope attribute from the template example at the beginning of this section.
            You can refer to configuration entries from any of the following sources (which the
            resolver will try in this order):
            <ul>
              <li>a configuration header in the template</li>
              <li>a configuration header in the corresponding document<br></li>
              <li>a configuration file with the name <code>directory.conf</code> inside the current directory</li>
              <li>a configuration file with the name <code>directory.conf</code> inside any parent directory</li>
              <li>a configuration file specified programmatically</li>
            </ul>
          </li>
        </ul>
        <p>The use of these references is meant to be quite straightforward. The template engine
        is logic-less, so if you find yourself creating complex constructs of these variable
        references and directives for looping, you should probably consider creating a custom
        directive. These are easy to implement and let you access all the variables listed
        above (and more) in Scala code.</p>
        <p>An example would be a highly customized generator for a table of contents (in case
        the one built-in is not sufficient for your needs). This can probably be easier
        achieved with a directive than with variable references.</p>
        
        <h3 id="directives" class="section">Directives</h3>
        <p>Directives are Laika&#39;s extension hook for both, templates and text markup.
        They always start with <code>@:</code>, the name of the directive, optionally followed 
        by one or more attributes enclosed between <code>{</code> and <code>}</code> and an optional
        body element ending on a <code>@:@</code> fence.</p>
        <p>A very minimal example is the <code>toc</code> directive for inserting a table of contents.
        Since all its attributes are optional, it can simply be used like this:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">toc</span></code></pre>
        <p>A more complete example is the use of the <code>for</code> directive:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">for</span><span> { </span><span class="string-literal">some.list.of.products</span><span> }

</span><span class="tag-punctuation">&lt;</span><span class="tag-name">li</span><span class="tag-punctuation">&gt;&lt;</span><span class="tag-name">a</span><span class="tag-punctuation"> </span><span class="attribute-name">href</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;#</span><span class="substitution">${_.id}</span><span class="string-literal">&quot;</span><span class="tag-punctuation">&gt;</span><span class="substitution">${_.description}</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">a</span><span class="tag-punctuation">&gt;&lt;/</span><span class="tag-name">li</span><span class="tag-punctuation">&gt;</span><span>

</span><span class="keyword">@:@</span></code></pre>
        <p>Here <code>for</code> is the name of the directive, <code>some.list.of.products</code> is an unnamed
        attribute (where in this case the value is interpreted as a variable reference,
        pointing to a path the user defined in the configuration),
        and finally, the body of the directive followed by the <code>@:@</code> fence. The exact
        semantics of this particular directive are explained in the section 
        <a href="#standard-template-directives">Standard Template Directives</a>.</p>
        <p>You can either use one of the built-in directives or create your own as
        described in <a href="../extending-laika/directive.html#directives">Directives</a>.</p>
        
        <h2 id="how-templates-are-matched-to-documents" class="section">How Templates are Matched To Documents</h2>
        <p>There are two simple options for specifying which template to use:</p>
        
        <h3 id="default-template-per-directory" class="section">Default Template per Directory</h3>
        <p>The most convenient way is to simply add a file with the name <code>default.template.&lt;suffix&gt;</code>
        (e.g. <code>default.template.html</code>) to the directory containing your text markup documents. 
        This template is then used for all documents in this directory and its subdirectories, 
        unless it is overridden by either a different default template in one of the 
        subdirectories or by explicitly specifying a template in one of the text markup documents.</p>
        
        <h3 id="explicit-template-per-document" class="section">Explicit Template per Document</h3>
        <p>Alternatively (or in addition to default templates) you can explicitly specify a template
        in a configuration header of a text markup document:</p>
        <pre><code class="nohighlight"><span class="keyword">{%</span><span>
  </span><span class="attribute-name">template</span><span>: </span><span class="string-literal">custom.template.html</span><span>
</span><span class="keyword">%}</span></code></pre>
        <p>This will override any default template for the directory. The path is relative to the
        document, but has to be somewhere below the root directory processed by Laika, as
        templates are parsed and cached upfront, before getting applied to documents.</p>
        <p>All templates must have the suffix <code>.template.&lt;suffix&gt;</code> where the suffix matches
        the output format of the transformation operation, e.g. <code>.template.html</code>.</p>
        
        <h2 id="standard-template-directives" class="section">Standard Template Directives</h2>
        <p>Laika comes with a small number of built-in directives intended to cover the most
        common scenarios. Some of them can only be used in templates, whereas others can
        also be used in text markup, as stated for each individual directive below.</p>
        
        <h3 id="the-toc-directive" class="section">The <code>toc</code> directive</h3>
        <p>Can be used in templates and as block elements in text markup.</p>
        <p>Generates a table of contents containing the documents of the tree
        and/or the sections inside these documents.</p>
        <p>This directive is explained in detail in the <a href="structure.html#document-structure">Document Structure</a> chapter.</p>
        
        <h3 id="the-fragment-directive" class="section">The <code>fragment</code> directive</h3>
        <p>Can only be used in block elements in text markup, not in templates (yet).</p>
        <p>Produces a block element which is not part of the main body of the markup
        document (so will not be rendered with a <code>${document.content}</code> reference).
        Instead it can be referred to by <code>${document.fragments.&lt;fragmentName&gt;}</code>.</p>
        <p>This allows to keep some sections of your document separate, to be rendered
        in different locations of the output, like headers, footers or sidebars.</p>
        <p>This directive is explained in detail in the <a href="structure.html#document-fragments">Document Structure</a> chapter.</p>
        
        <h3 id="the-format-directive" class="section">The <code>format</code> directive</h3>
        <p>Can only be used in block elements in text markup.</p>
        <p>The body of such a directive will only be included into the
        output by renderers for the specified type:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">format</span><span> { </span><span class="string-literal">html</span><span> }

This text only appears in the HTML output,
not in PDF, EPUB or any other format.

</span><span class="keyword">@:@</span></code></pre>
        <p>Note that the body of a block directive needs to be indented,
        and does not appear between curly braces.</p>
        
        <h3 id="the-style-directive" class="section">The <code>style</code> directive</h3>
        <p>Can be used in block and span elements in text markup.</p>
        <p>Adds a style to the root element of the body of the directive,
        that can be used by renderers to change the appearance of the
        rendered element.</p>
        <p>Block directive: </p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">style</span><span> { </span><span class="string-literal">subtitle</span><span> } 

This paragraph gets the 
subtitle style applied.

</span><span class="keyword">@:@</span><span>
  
While this paragraph does not.</span></code></pre>
        <p>Span directive:</p>
        <pre><code class="nohighlight"><span>Burrito - </span><span class="keyword">@:</span><span class="identifier">style</span><span> { </span><span class="string-literal">price</span><span> } Â£3.50 </span><span class="keyword">@:@</span><span>.</span></code></pre>
        
        <h3 id="the-for-directive" class="section">The <code>for</code> directive</h3>
        <p>Can only be used inside templates.</p>
        <p>Executes the body of the directive multiple times for each element of
        a non-empty collection (or array-type entry in a configuration section),
        not at all for the values <code>null</code>, <code>false</code>, <code>None</code>, empty strings and
        empty collections, and exactly once for all other values.</p>
        <p>In case of non-empty values their properties will be made available
        for use inside the body part without any prefix:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">for</span><span> { </span><span class="string-literal">some.list.of.products</span><span> }

</span><span class="tag-punctuation">&lt;</span><span class="tag-name">li</span><span class="tag-punctuation">&gt;&lt;</span><span class="tag-name">a</span><span class="tag-punctuation"> </span><span class="attribute-name">href</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;#</span><span class="substitution">${_.id}</span><span class="string-literal">&quot;</span><span class="tag-punctuation">&gt;</span><span class="substitution">${_.description}</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">a</span><span class="tag-punctuation">&gt;&lt;/</span><span class="tag-name">li</span><span class="tag-punctuation">&gt;</span><span>

</span><span class="keyword">@:@</span><span> </span></code></pre>
        <p>In this example <code>id</code> and <code>title</code> are properties of the <code>SectionInfo</code>
        objects inside the <code>document.sections</code> collection.</p>
        <p>You can also specify a fallback, a body part that gets executed
        for empty values:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">for</span><span> { </span><span class="string-literal">some.list.of.products</span><span> }
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">li</span><span class="tag-punctuation">&gt;&lt;</span><span class="tag-name">a</span><span class="tag-punctuation"> </span><span class="attribute-name">href</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;#</span><span class="substitution">${_.id}</span><span class="string-literal">&quot;</span><span class="tag-punctuation">&gt;</span><span class="substitution">${_.description}</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">a</span><span class="tag-punctuation">&gt;&lt;/</span><span class="tag-name">li</span><span class="tag-punctuation">&gt;</span><span>
 
</span><span class="keyword">@:</span><span class="identifier">empty</span><span>
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">p</span><span class="tag-punctuation">&gt;</span><span>No products available.</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">p</span><span class="tag-punctuation">&gt;</span><span>

</span><span class="keyword">@:@</span></code></pre>
        <p>Each directive can have one unnamed default body and any number
        of named bodies. The <code>for</code> directive supports a body element
        named <code>empty</code>, the name has to be enclosed in <code>~</code> and <code>:</code> and
        the body in braces like always. This combination of characters
        is still readable, relatively easy to memorize, while minimizing
        the likeliness to conflict with plain template text.</p>
        
        <h3 id="the-if-directive" class="section">The <code>if</code> directive</h3>
        <p>Can only be used inside templates.</p>
        <p>Executes the body of the directive exactly once for a Boolean
        <code>true</code> or the strings <code>true</code>, <code>on</code>, <code>yes</code> and <code>enabled</code>.</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">if</span><span> { </span><span class="string-literal">showSidebar</span><span> }
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">div</span><span class="tag-punctuation"> </span><span class="attribute-name">class</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;sidebar&quot;</span><span class="tag-punctuation">&gt;</span><span>...</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">div</span><span class="tag-punctuation">&gt;</span><span>
</span><span class="keyword">@:@</span></code></pre>
        <p>In this example <code>showSidebar</code> is a custom configuration entry
        that you have set explicitly in a configuration header or file.</p>
        <p>You can also specify a fallback with <code>@:else</code>, 
        or even secondary conditions with <code>@:elseIf</code>:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">if</span><span> { </span><span class="string-literal">showSidebar</span><span> }
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">div</span><span class="tag-punctuation"> </span><span class="attribute-name">class</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;sidebar&quot;</span><span class="tag-punctuation">&gt;</span><span>...</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">div</span><span class="tag-punctuation">&gt;</span><span>

</span><span class="keyword">@:</span><span class="identifier">elseIf</span><span> { </span><span class="string-literal">showInfobox</span><span> }
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">div</span><span class="tag-punctuation"> </span><span class="attribute-name">class</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;infobox&quot;</span><span class="tag-punctuation">&gt;</span><span>...</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">div</span><span class="tag-punctuation">&gt;</span><span>

</span><span class="keyword">@:</span><span class="identifier">else</span><span>
</span><span class="tag-punctuation">&lt;</span><span class="tag-name">p</span><span class="tag-punctuation">&gt;</span><span>Something else</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">p</span><span class="tag-punctuation">&gt;</span><span>

</span><span class="keyword">@:@</span></code></pre>
        
        <h3 id="the-pagebreak-directive" class="section">The <code>pageBreak</code> directive</h3>
        <p>Can only be used in block elements in text markup.</p>
        <p>Only page-oriented output formats like PDF or XSL-FO
        know how to render page break elements.</p>
        <p>This directive does not support any attributes:</p>
        <pre><code class="nohighlight"><span class="keyword">@:</span><span class="identifier">pageBreak</span></code></pre>      

      </div>
    </div>

  </div>

</body></html>
